<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="utf-8" />
	<link rel="icon" href="/ufo-web/favicon.png" />
	<meta name="viewport" content="width=device-width" />
	<meta http-equiv="content-security-policy" content="">
		<link href="/ufo-web/internal/immutable/assets/_page-ce5f9796.css" rel="stylesheet">
		<link rel="modulepreload" href="/ufo-web/internal/immutable/start-9b1cc3a6.js">
		<link rel="modulepreload" href="/ufo-web/internal/immutable/chunks/index-f3733c48.js">
		<link rel="modulepreload" href="/ufo-web/internal/immutable/chunks/singletons-109ceddc.js">
		<link rel="modulepreload" href="/ufo-web/internal/immutable/chunks/index-6e6c57e8.js">
		<link rel="modulepreload" href="/ufo-web/internal/immutable/components/layout.svelte-f0160a83.js">
		<link rel="modulepreload" href="/ufo-web/internal/immutable/modules/pages/_layout.js-5612100c.js">
		<link rel="modulepreload" href="/ufo-web/internal/immutable/chunks/_layout-79cb23d1.js">
		<link rel="modulepreload" href="/ufo-web/internal/immutable/components/pages/_page.svelte-3764073c.js">

	<script src="https://d3js.org/d3.v4.min.js"></script>

	<script src="https://cdnjs.cloudflare.com/ajax/libs/d3-legend/2.25.6/d3-legend.min.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/d3-legend/2.13.0/d3-legend.js"></script>
</head>

<body data-sveltekit-preload-data="hover">
	<div style="display: contents;">


<div class="page"><main class="svelte-1sstto3"><div class="header svelte-1sstto3"><div class="header  svelte-1v64djn"><h1 class="svelte-1v64djn">Useless Fisualization Operation</h1>
	<div class="menu svelte-1v64djn"><button class="menu-button svelte-1v64djn">Map</button>
		
		<button class="menu-button svelte-1v64djn">Relations</button>
		
		<button class="menu-button svelte-1v64djn">Days of the year
		</button>
		</div>
</div></div>
		<div class="details svelte-1sstto3"><div class=" details card svelte-1qgkmur"><center><p class="description svelte-1qgkmur">ðŸ’¡ Click on a state, airport, or UFO to see more information.
			</p></center></div>


<dialog class="svelte-1x2cfa0"><div class="svelte-1x2cfa0">
		<hr>
		
		<hr>
		</div>
</dialog></div>
		<div class="display_options svelte-1sstto3"><div class="card  svelte-ixxw6d"><div class="legend svelte-ixxw6d"><center><h4 class="title">Filter</h4></center>
		
		<div class="item svelte-ixxw6d"><input type="checkbox" class="svelte-ixxw6d" checked>
			<div class="ufo_legend svelte-ixxw6d"></div>
			<p class="desc svelte-ixxw6d">â–¶
				UFO sighting
			</p></div>
		
		<div class="item svelte-ixxw6d"><input type="checkbox" class="svelte-ixxw6d">
			<div class="airport_legend svelte-ixxw6d"></div>
			<p class="desc svelte-ixxw6d">â–¶
				Airports
			</p></div>
		
		<div class="item svelte-ixxw6d"><input type="checkbox" class="svelte-ixxw6d" checked>
			<div class="religion_legend svelte-ixxw6d"></div>
			<p class="desc svelte-ixxw6d">Importance of Religion</p></div>
		<div class="item svelte-ixxw6d"><input type="checkbox" class="svelte-ixxw6d">
			<div class="city_legend svelte-ixxw6d"></div>
			<p class="desc svelte-ixxw6d">Cities</p></div></div>
</div></div>
		<div class="time_slider svelte-1sstto3"><div class=" time svelte-15f6zd5">
	<div class="dates svelte-15f6zd5"><input type="date" class="svelte-15f6zd5" value="2020-01-01">
		<input type="date" class="svelte-15f6zd5" value="2023-01-01"></div>
</div></div>
		<div class="footer svelte-1sstto3"><div class="footer  svelte-iq9fkt">
</div></div>
		<div class="legend svelte-1sstto3"><div class=" legend card svelte-1erw2ue"><div style="background-color:rgb(173, 240, 221)" class="svelte-1erw2ue">0%</div><div style="background-color:rgb(137, 197, 180)" class="svelte-1erw2ue">25%</div><div style="background-color:rgb(100, 153, 138)" class="svelte-1erw2ue">50%</div><div style="background-color:rgb(64, 110, 97); color:#adf0dd" class="svelte-1erw2ue">75%</div><div style="background-color:rgb(27, 66, 55); color:#adf0dd" class="svelte-1erw2ue">100%</div>
</div></div>
		<div class="map svelte-1sstto3">

<div class="loading-screen svelte-194q9uk"><div class="lds-ring svelte-nabib3" style="display: block"><div class="svelte-nabib3"></div>
	<div class="svelte-nabib3"></div>
	<div class="svelte-nabib3"></div>
	<div class="svelte-nabib3"></div>
</div></div>

<div class=" svelte-194q9uk"><svg width="0" height="0" viewBox="0 0 800 800" preserveAspectRatio="xMidYMid meet" class="svelte-194q9uk"><g></g></svg>
</div></div></main>
	<div class="about hidden svelte-1sstto3"><div class="about card svelte-121ajr9"><h1 class="svelte-121ajr9">About</h1>
	<div><div class="projectdesc svelte-121ajr9">Ufos. This is us.
		</div>
		<div class="groupmembers svelte-121ajr9"><div class="member svelte-121ajr9"><img src="https://s3.amazonaws.com/pix.iemoji.com/images/emoji/apple/ios-12/256/alien.png" class="svelte-121ajr9">
				<p>Albin Kempe</p></div>
			<div class="member svelte-121ajr9"><img src="https://s3.amazonaws.com/pix.iemoji.com/images/emoji/apple/ios-12/256/alien.png" class="svelte-121ajr9">
				<p>Jonathan Cilli</p></div>
			<div class="member svelte-121ajr9"><img src="https://s3.amazonaws.com/pix.iemoji.com/images/emoji/apple/ios-12/256/alien.png" class="svelte-121ajr9">
				<p>Pedro Burgos</p></div>
			<div class="member svelte-121ajr9"><img src="https://s3.amazonaws.com/pix.iemoji.com/images/emoji/apple/ios-12/256/alien.png" class="svelte-121ajr9">
				<p>Annika Oehri</p></div>
			<div class="member svelte-121ajr9"><img src="https://s3.amazonaws.com/pix.iemoji.com/images/emoji/apple/ios-12/256/alien.png" class="svelte-121ajr9">
				<p>Frawa Vetterli</p></div></div></div>
	
</div></div>
	<div class="chart hidden svelte-1sstto3"><div class="scatterplot svelte-w7lv0o"><style>circle {
			fill: var(--accent);
			opacity: 0.6;
		}

		line {
			stroke-width: 1px;
			opacity: 0.6;
		}

		text {
			font-size: 0.8em;
		}
	</style>
	<h4 class="title">Relationship between UFO Sightings and Other Attributes</h4>

	<div id="controls"><p class="svelte-w7lv0o">Sightings from year <input type="number" id="button_start_year" onkeydown="return false" class="svelte-w7lv0o">
			to
			<input type="number" id="button_end_year" onkeydown="return false" class="svelte-w7lv0o"></p>
		<p class="svelte-w7lv0o">First Attribute (X axis):
			<span class="xvar"><select class="xvar svelte-w7lv0o" name="xvar"></select></span></p>
		<p class="svelte-w7lv0o">Second Attribute (Y axis):
			<span class="yvar"><select class="yvar svelte-w7lv0o" name="yvar"></select></span></p></div>

	<svg id="scatter-container" class="svelte-w7lv0o"></svg>

	

	<script>function sleep(time) {
			return new Promise((resolve) => {
				setTimeout(() => {
					resolve();
				}, time);
			});
		}

		sleep(3000).then(() => {
			// how long transitions last (msec)
			let transitionTime = 2000;
			let state_indices =
				//changed for full rel
				[
					'AK',
					'AL',
					'AR',
					'AZ',
					'CA',
					'CO',
					'CT',
					'DC',
					'DE',
					'FL',
					'GA',
					'HI',
					'IA',
					'ID',
					'IL',
					'IN',
					'KS',
					'KY',
					'LA',
					'MA',
					'MD',
					'ME',
					'MI',
					'MN',
					'MO',
					'MS',
					'MT',
					'NC',
					'ND',
					'NE',
					'NH',
					'NJ',
					'NM',
					'NV',
					'NY',
					'OH',
					'OK',
					'OR',
					'PA',
					'RI',
					'SC',
					'SD',
					'TN',
					'TX',
					'UT',
					'VA',
					'VT',
					'WA',
					'WI',
					'WV',
					'WY'
				];

			let longStates = {
				AL: 'Alabama',
				AK: 'Alaska',
				AZ: 'Arizona',
				AR: 'Arkansas',
				CA: 'California',
				CO: 'Colorado',
				CT: 'Connecticut',
				DE: 'Delaware',
				DC: 'District of Columbia',
				FL: 'Florida',
				GA: 'Georgia',
				HI: 'Hawaii',
				ID: 'Idaho',
				IL: 'Illinois',
				IN: 'Indiana',
				IA: 'Iowa',
				KS: 'Kansas',
				KY: 'Kentucky',
				LA: 'Louisiana',
				ME: 'Maine',
				MD: 'Maryland',
				MA: 'Massachusetts',
				MI: 'Michigan',
				MN: 'Minnesota',
				MS: 'Mississippi',
				MO: 'Missouri',
				MT: 'Montana',
				NE: 'Nevada',
				NV: 'Nebraska',
				NH: 'New Hampshire',
				NJ: 'New Jersey',
				NM: 'New Mexico',
				NY: 'New York',
				NC: 'North Carolina',
				ND: 'North Dakota',
				OH: 'Ohio',
				OK: 'Oklahoma',
				OR: 'Oregon',
				PA: 'Pennsylvania',
				RI: 'Rhode Island',
				SC: 'South Carolina',
				SD: 'South Dakota',
				TN: 'Tennessee',
				TX: 'Texas',
				UT: 'Utah',
				VT: 'Vermont',
				VA: 'Virginia',
				WA: 'Washington',
				WV: 'West Virginia',
				WI: 'Wisconsin',
				WY: 'Wyoming'
			};

			let longVars = {
				Num_Sightings: 'Number of UFO sightings',
				Rel_Num_Sightings: 'Number of UFO sightings per resident', //changed for full rel
				Rel_Very_important: 'Religion: very important',
				Rel_Somewhat_important: 'Religion: somewhat important',
				Rel_Not_too_important: 'Religion: not too important',
				Rel_Not_at_all_important: 'Religion: not at all important',
				Rel_Dont_know: "Religion: don't know how important",
				Population_Density: 'Population density',
				Total_Resident_Population: 'Total population',
				Illicit_Drug_Use: 'Illicit Drug Use', //changed for full rel
				Marijuana_Use: 'Marijuana Use', //changed for full rel
				Illicit_Drug_Use_Other_Than_Marijuana: 'Illicit Drug Use Other Than Marijuana', //changed for full rel
				Binge_Alcohol_Use: 'Binge Alcohol Use', //changed for full rel
				Illicit_Drug_Use_Disorder: 'Illicit Drug Use Disorder', //changed for full rel
				Serious_Mental_Illness: 'Serious Mental Illness', //changed for full rel
				Any_Mental_Illness: 'Any Mental Illness' //changed for full rel
			};

			// use Margin Convention to layout the SVG with an inner plotting region
			// and an outer region for axes, labels, etc.
			let outerWidth = 600;
			let outerHeight = 400;
			let margins = { top: 10, bottom: 60, left: 60, right: 30 };
			let innerWidth = outerWidth - margins.left - margins.right;
			let innerHeight = outerHeight - margins.top - margins.bottom;

			let scatterOuter = d3
				.select('svg#scatter-container')
				.attr('width', outerWidth)
				.attr('height', outerHeight);

			let scatterInner = scatterOuter
				.append('g')
				.attr('id', 'inner-region')
				.attr('width', innerWidth)
				.attr('height', innerHeight)
				.attr('transform', 'translate(' + margins.left + ',' + margins.top + ')');

			// load data
			let url_other =
				'https://raw.githubusercontent.com/vfrawa/vfrawa.github.io/main/scatterplot_data_full_relative_drugsincl.csv';
			//let url_other = "https://raw.githubusercontent.com/vfrawa/vfrawa.github.io/main/scatterplot_data_full_relative.csv"
			//let url_other = "https://raw.githubusercontent.com/useless-fisualization-operation/ufo-web/main/dataset/scatterplot_data.csv"
			//let url_sight = "https://raw.githubusercontent.com/useless-fisualization-operation/ufo-web/main/dataset/num_sightings_per_state_per_year.csv"
			//let url_sight = "https://raw.githubusercontent.com/useless-fisualization-operation/ufo-web/main/dataset/num_sightings_per_state_per_year.csv"
			let url_sight =
				'https://raw.githubusercontent.com/vfrawa/vfrawa.github.io/main/relative_num_sightings_per_state_per_year_timespan_rows_full.csv';
			let url_sight_abs =
				'https://raw.githubusercontent.com/vfrawa/vfrawa.github.io/main/num_sightings_per_state_per_year_timespan_rows_full.csv'; //changed for x axis
			d3.csv(url_other, cleanup_data, function (error, d_other) {
				if (error) {
					console.log(error);
					return;
				}
				d3.csv(url_sight, cleanup_data, function (error, d_sight) {
					if (error) {
						console.log(error);
						return;
					}
					d3.csv(url_sight_abs, cleanup_data, function (error, d_sight_abs) {
						if (error) {
							console.log(error);
							return;
						}
						setup(d_other, d_sight, d_sight_abs);
						update(d_other, d_sight, d_sight_abs);
					});
				});
			});

			// d3.csv() reads in everything as a string.  convert all string numbers to numbers.
			function cleanup_data(d) {
				for (k of Object.keys(d)) {
					if (k != 'State') d[k] = +d[k];
				}
				return d;
			}

			// declare some variables that will be assigned in functions below
			let d_other_global = [];
			let d_sight_global = [];
			let d_sight_abs_global = []; //changed for x axis
			let xScale, yScale;
			let xAxis, yAxis;
			let min_year = 1910,
				max_year = 2023;

			function get_state_year_idx(state, start_year, end_year) {
				//changed for full rel
				state_idx = state_indices.indexOf(state);
				start_year_idx = start_year - min_year;
				end_year_idx = end_year - min_year;
				return (
					state_idx * 6555 +
					(114.5 - start_year_idx / 2.0) * start_year_idx +
					end_year_idx -
					start_year_idx
				);
			}

			// setup() is for setting up plot elements once at the beginning
			// update() will be used for the initial draw and for redrawing upon change
			//function setup(d_other, d_sight) {
			function setup(d_other, d_sight, d_sight_abs) {
				//changed for x axis
				d_other_global = d_other;
				d_sight_global = d_sight;
				d_sight_abs_global = d_sight_abs; //changed for x axis

				//State is not quantitative, so it shouldn't be selected
				//let variables = Object.keys(d_other[0]).filter(d => d != 'model')
				//let variables = Object.keys(d_other[0]).filter(d => d != 'State' && d!="Rel_Sample_size" & d!="Num_Sightings")
				let variables = Object.keys(d_other[0]).filter(
					(d) =>
						d != 'State' &&
						(d != 'Rel_Sample_size') & (d != 'Num_Sightings') & (d != 'Rel_Num_Sightings')
				); //changed for full rel
				let x_variables = ['Num_Sightings', 'Rel_Num_Sightings']; //changed for x axis

				// border around plotting region
				/*scatterInner
			.append('rect')
			.attr('width', innerWidth)
			.attr('height', innerHeight)
			.attr('fill', 'transparent')
			//.attr('stroke', 'black')*/

				// populate selectors
				d3.select('select.xvar') //changed for x axis
					//.on('change', () => update(d_other_global, d_sight_global)) // make sure .on() is above .selectAll()
					.on('change', () => update(d_other_global, d_sight_global, d_sight_abs_global)) //changed for x axis
					.selectAll('option')
					.data(x_variables)
					.enter()
					.append('option')
					.attr('value', (d) => d)
					.text((d) => longVars[d]);

				d3.select('select.yvar')
					//.on('change', () => update(d_other_global, d_sight_global)) // make sure .on() is above .selectAll()
					.on('change', () => update(d_other_global, d_sight_global, d_sight_abs_global)) //changed for x axis
					.selectAll('option')
					.data(variables)
					.enter()
					.append('option')
					.attr('value', (d) => d)
					.text((d) => longVars[d]);

				d3.select('#button_start_year').on('input', () => {
					//update(d_other_global, d_sight_global); //changed for x axis
					update(d_other_global, d_sight_global, d_sight_abs_global);
				});

				d3.select('#button_end_year').on('input', () => {
					//update(d_other_global, d_sight_global);//changed for x axis
					update(d_other_global, d_sight_global, d_sight_abs_global);
				});

				// initialize values of select elements.
				d3.select('select.xvar').property('value', 'Rel_Num_Sightings'); //changed for x axis
				d3.select('select.yvar').property('value', 'Population_Density');
				d3.select('#button_start_year').property('value', min_year);
				d3.select('#button_end_year').property('value', max_year);

				d3.select('#button_start_year').property('min', min_year);
				d3.select('#button_start_year').property(
					'max',
					d3.select('#button_end_year').property('value')
				);
				d3.select('#button_end_year').property(
					'min',
					d3.select('#button_start_year').property('value')
				);
				d3.select('#button_end_year').property('max', max_year);

				// read current selections
				//let xvar = 'Num_Sightings'
				//let xvar = 'Rel_Num_Sightings' //changed for full rel
				let xvar = d3.select('select.xvar').property('value'); //changed for x axis
				let yvar = d3.select('select.yvar').property('value');
				let start_year = +d3.select('#button_start_year').property('value');
				let end_year = +d3.select('#button_end_year').property('value');

				//change Num_sightings in d_other s.t. they reflect the chosen year range
				d_other.map((d) => {
					//d_sight_curr = d_sight.filter(d_s => d_s["Year"] == start_year && d_s["State"]==d["State"]);
					//d_sight_curr = d_sight.filter(d_s => d_s["Start_Year"] == start_year && d_s["Stop_Year"] == end_year && d_s["State"]==d["State"]);
					//d_sight_curr = [d_sight[get_state_year_idx(d["State"], start_year, end_year)]]//changed for full rel
					if (xvar == 'Num_Sightings') {
						//changed for x axis
						d_sight_curr = [d_sight_abs[get_state_year_idx(d['State'], start_year, end_year)]];
					} else {
						d_sight_curr = [d_sight[get_state_year_idx(d['State'], start_year, end_year)]];
					}

					//d["Num_Sightings"] = d_sight_curr[0]["Num_Sightings"];
					//d["Rel_Num_Sightings"] = d_sight_curr[0]["Rel_Num_Sightings"]; //changed for full rel
					d['Rel_Num_Sightings'] = d_sight_curr[0][xvar]; //changed for x axis
					return;
				});

				// create scales based on selections
				// the domain will be modified when selections change
				if (xvar == 'Num_Sightings') {
					//changed for x axis
					x_domain_max = d3.max([1, d3.max(d_other.map((d) => d['Rel_Num_Sightings']))]);
				} else {
					x_domain_max = d3.max(d_other.map((d) => d['Rel_Num_Sightings']));
				}

				xScale = d3
					.scaleLinear()
					//.domain([0, d3.max([1, d3.max(d_other.map(d => d[xvar]))])])//changed for full rel
					//.domain([0, 1, d3.max(d_other.map(d => d[xvar]))]) //changed for x axis, evtl Fehler drin und man mÃ¼sste 1 sowieso rausnehmen
					.domain([0, x_domain_max]) //changed for x axis
					.range([0, innerWidth]);
				xAxis = d3.axisBottom(xScale).tickSize(-innerHeight);

				yScale = d3
					.scaleLinear()
					.domain([0, d3.max(d_other.map((d) => d[yvar]))])
					.range([0, innerHeight].reverse());
				yAxis = d3.axisLeft(yScale).tickSize(-innerWidth);

				// create axes
				scatterInner
					.append('g')
					.attr('transform', 'translate(' + 0 + ', ' + innerHeight + ')')
					.attr('class', 'x axis') // note: two classes; handy!
					.call(xAxis);

				scatterInner.append('g').attr('class', 'y axis').call(yAxis);

				scatterOuter
					.append('text')
					.attr('class', 'x axis')
					.attr('x', margins.left + innerWidth / 2)
					.attr('y', outerHeight - margins.bottom / 2)
					.attr('text-anchor', 'middle')
					.text(longVars[xvar]);

				scatterOuter
					.append('text')
					.attr('class', 'y axis')
					.attr('x', margins.left / 2)
					.attr('y', margins.top + innerHeight / 2)
					.attr('text-anchor', 'middle')
					.attr('transform', `rotate(-90 ${margins.left / 2} ${margins.top + innerHeight / 2})`)
					.text(longVars[yvar]);

				//var slider = createD3RangeSlider(0, 10, "#slider-container");
				/*
			rangeSlider(document.querySelector('#slider-container'), {
			//orientation: 'vertical'
			// min value
			min: 1910,
			// max value
			max: 2023,
			
			// step size
			step: 1,
			});

			d3.select("div#slider3")
						.call(d3.slider().axis(true).min(0).max(10).value([2,4])
						.on("slide", function(evt,value) {
							dispatch.filter(value);
							d3.select("#slider3textmin").text(Math.floor(value[0]));
							d3.select("#slider3textmax").text(Math.floor(value[1]))
						}))*/
			}

			// update elements that get modified when selections change
			//function update(d_other, d_sight) {
			function update(d_other, d_sight, d_sight_abs) {
				//let xvar = 'Num_Sightings'
				//let xvar = 'Rel_Num_Sightings' //changed for full res
				let xvar = d3.select('select.xvar').property('value'); //changed for x axis
				let yvar = d3.select('select.yvar').property('value');
				let start_year = +d3.select('#button_start_year').property('value');
				let end_year = +d3.select('#button_end_year').property('value');

				d3.select('#button_start_year').property('min', min_year);
				d3.select('#button_start_year').property(
					'max',
					d3.select('#button_end_year').property('value')
				);
				d3.select('#button_end_year').property(
					'min',
					d3.select('#button_start_year').property('value')
				);
				d3.select('#button_end_year').property('max', max_year);

				//change Num_sightings in d_other s.t. they refelct the chosen year range
				d_other.map((d) => {
					//d_sight_curr = d_sight.filter(d_s => d_s["Year"] == start_year && d_s["State"]==d["State"]);
					//d_sight_curr = d_sight.filter(d_s => d_s["Start_Year"] == start_year && d_s["Stop_Year"] == end_year && d_s["State"]==d["State"]);
					//d_sight_curr = [d_sight[get_state_year_idx(d["State"], start_year, end_year)]]//changed for full rel

					if (xvar == 'Num_Sightings') {
						//changed for x axis
						d_sight_curr = [d_sight_abs[get_state_year_idx(d['State'], start_year, end_year)]];
					} else {
						d_sight_curr = [d_sight[get_state_year_idx(d['State'], start_year, end_year)]];
					}

					//d["Num_Sightings"] = d_sight_curr[0]["Num_Sightings"];
					//d["Rel_Num_Sightings"] = d_sight_curr[0]["Rel_Num_Sightings"];//changed for full res
					d['Rel_Num_Sightings'] = d_sight_curr[0][xvar]; //changed for x axis
					return;
				});

				// update scales
				// the domain will be modified when selections change
				if (xvar == 'Num_Sightings') {
					//changed for x axis
					x_domain_max = d3.max([1, d3.max(d_other.map((d) => d['Rel_Num_Sightings']))]);
				} else {
					x_domain_max = d3.max(d_other.map((d) => d['Rel_Num_Sightings']));
				}

				//xScale.domain([0, d3.max([1, d3.max(d_other.map(d => d[xvar]))])])//changed for full rel
				//xScale.domain([0, d3.max(d_other.map(d => d[xvar]))])
				xScale.domain([0, x_domain_max]); //changed for x axis
				yScale.domain([0, d3.max(d_other.map((d) => d[yvar]))]);

				// update axes
				scatterInner.select('.x.axis').transition().duration(transitionTime).call(xAxis);
				scatterInner.select('.y.axis').transition().duration(transitionTime).call(yAxis);

				// main plot
				scatterInner
					.selectAll('circle')
					.data(d_other)
					.enter()
					.append('circle')
					.attr('cx', function (d) {
						return xScale(d['Rel_Num_Sightings']);
					}) // changed for x axis
					.attr('cy', function (d) {
						return yScale(d[yvar]);
					})
					.attr('r', 4)
					.append('title') // TITLE APPENDED HERE
					.text(function (d) {
						return longStates[d['State']];
					});

				scatterInner.selectAll('circle').data(d_other).exit().remove();

				scatterInner
					.selectAll('circle')
					.data(d_other)
					.transition()
					.duration(transitionTime)
					.attr('cx', function (d) {
						return xScale(d['Rel_Num_Sightings']);
					}) // changed for x axis
					.attr('cy', function (d) {
						return yScale(d[yvar]);
					});

				// axis labels
				scatterOuter //changed for x axis
					.selectAll('text.x.axis') // select text elements with two both classes
					.transition()
					.duration(transitionTime)
					.text(longVars[xvar]);

				scatterOuter
					.selectAll('text.y.axis') // select text elements with two both classes
					.transition()
					.duration(transitionTime)
					.text(longVars[yvar]);
			}
		});
	</script>
</div></div>
	<div class="heatmap hidden svelte-1sstto3"><div class="heatmap svelte-t347tn"><h4 class="title">UFO sightings per day of the year</h4>

	<div id="my_dataviz"></div>
	<script>function sleep(time) {
			return new Promise((resolve) => {
				setTimeout(() => {
					resolve();
				}, time);
			});
		}

		sleep(3000).then(() => {
			// set the dimensions and margins of the graph
			var margin = { top: 30, right: 120, bottom: 40, left: 50 },
				width = 750 - margin.left - margin.right,
				height = 450 - margin.top - margin.bottom;

			// append the svg object to the body of the page
			var svg = d3
				.select('#my_dataviz')
				.append('svg')
				.attr('width', width + margin.left + margin.right)
				.attr('height', height + margin.top + margin.bottom)
				.append('g')
				.attr('transform', 'translate(' + margin.left + ',' + margin.top + ')');

			// Labels of row and columns
			var myGroups = ['1', '2', '3', '4', '5', '6', '7', '8', '9', '10', '11', '12'];
			var months = ['Jan', 'Feb', '3', '4', '5', '6', '7', '8', '9', '10', '11', '12'];
			var myVars = [
				'1',
				'2',
				'3',
				'4',
				'5',
				'6',
				'7',
				'8',
				'9',
				'10',
				'11',
				'12',
				'13',
				'14',
				'15',
				'16',
				'17',
				'18',
				'19',
				'20',
				'21',
				'22',
				'23',
				'24',
				'25',
				'26',
				'27',
				'28',
				'29',
				'30',
				'31'
			];

			let tickLabels = [
				'Jan',
				'Feb',
				'Mar',
				'Apr',
				'May',
				'June',
				'July',
				'Aug',
				'Sept',
				'Oct',
				'Nov',
				'Dec'
			];
			let fullmonths = [
				'January',
				'February',
				'March',
				'April',
				'May',
				'June',
				'July',
				'August',
				'September',
				'October',
				'November',
				'December'
			];
			var x = d3
				.scaleBand()
				.range([0, width - 120])
				.domain(myGroups)
				.padding(0.01);
			let xAxisGenerator = d3.axisBottom(x);
			xAxisGenerator.tickFormat((d, i) => tickLabels[i]);
			let xAxis = svg
				.append('g')
				.attr('transform', 'translate(0,' + height + ')')
				.call(xAxisGenerator);

			// Build X scales and axis:
			/*   var x = d3.scaleBand()
    .range([ 0, width-120 ])
    .domain(myGroups)
    .padding(0.01);
  svg.append("g")
    .attr("transform", "translate(0," + height + ")")
    .call(d3.axisBottom(x)) */

			// Build y scales and axis:
			var y = d3.scaleBand().range([height, 0]).domain(myVars).padding(0.01);
			svg.append('g').call(d3.axisLeft(y));

			svg
				.append('text') // text label for the x axis
				.attr('x', width / 2)
				.attr('y', height + 0.8 * margin.bottom)
				.style('text-anchor', 'middle')
				.text('Month');

			svg
				.append('text')
				.attr('transform', 'rotate(-90)')
				.attr('y', 0 - margin.left)
				.attr('x', 0 - height / 2)
				.attr('dy', '1em')
				.style('text-anchor', 'middle')
				.text('Day');

			//Read the data
			d3.csv(
				'https://raw.githubusercontent.com/useless-fisualization-operation/ufo-datasets/a5df12234acafc689853dda5715cca2c9968077a/Data.csv',
				function (data) {
					//data preprocessing (get frequency)
					var tally = {};
					var last_Date = '';

					data.forEach(function (line) {
						var parts = line['Date'].split(' ');
						//console.log(parts[0]);//parts 0 has date, parts 1 has time
						//var datetime = formatDate.parse(parts[0]);
						//console.log(datetime);
						//var date = formatDate(datetime).split(' ')[0];
						var date = parts[0];
						var month = date.split('/')[0];
						var day = date.split('/')[1];
						date = day + '/' + month; //ignore year for now
						//console.log(date);
						tally[date] = (tally[date] || 0) + 1;
						last_Date = date;
					});

					var data_ref = [];

					for (var date in tally) {
						if (tally.hasOwnProperty(date)) {
							data_ref.push({
								month: date.split('/')[1],
								day: date.split('/')[0],
								frequency: tally[date]
							});
						}
					}

					// Build color scale
					var myColor = d3
						.scaleLinear()
						.range(['white', '#995e9f'])
						.domain([0, d3.max(data_ref, (d) => d.frequency)]);

					var legend = d3
						.legendColor()
						.scale(myColor)
						.labelFormat(d3.format('.0f'))
						.title('UFO Sightings');

					svg.append('g').attr('transform', 'translate(500,100)').call(legend);

					// create a tooltip
					var tooltip = d3
						.select('#my_dataviz')
						.append('div')
						.style('opacity', 0)
						.attr('class', 'tooltip')
						.style('background-color', 'white')
						.style('padding', '5px');

					// Three function that change the tooltip when user hover / move / leave a cell
					var mouseover = function (d) {
						tooltip.style('opacity', 1);
					};
					var mousemove = function (d) {
						var day = d.day + 'th';
						if (d.day == 1 || d.day == 21 || d.day == 31) {
							day = d.day + 'st';
						}
						if (d.day == 2 || d.day == 22) {
							day = d.day + 'nd';
						}
						if (d.day == 3 || d.day == 23) {
							day = d.day + 'rd';
						}
						var month = fullmonths[d.month - 1];
						tooltip
							.html(
								'On the ' +
									day +
									' of ' +
									month +
									' there were ' +
									d.frequency +
									' UFO sightings in total'
							)
							.style('left', d3.mouse(this)[0] + 70 + 'px')
							.style('top', d3.mouse(this)[1] + 'px');
					};
					var mouseleave = function (d) {
						tooltip.style('opacity', 0);
					};

					// add the squares
					svg
						.selectAll()
						.data(data_ref, function (d) {
							return d.month + ':' + d.day;
						})
						.enter()
						.append('rect')
						.attr('x', function (d) {
							return x(d.month);
						})
						.attr('y', function (d) {
							return y(d.day);
						})
						.attr('width', x.bandwidth())
						.attr('height', y.bandwidth())
						.style('fill', function (d) {
							return myColor(d.frequency);
						})
						.on('mouseover', mouseover)
						.on('mousemove', mousemove)
						.on('mouseleave', mouseleave);
				}
			);
		});
	</script>
</div></div>
</div>


		<script type="module" data-sveltekit-hydrate="irqanq">
			import { start } from "/ufo-web/internal/immutable/start-9b1cc3a6.js";

			start({
				assets: "/ufo-web",
				env: {},
				target: document.querySelector('[data-sveltekit-hydrate="irqanq"]').parentNode,
				version: "1678797983626",
				hydrate: {
					node_ids: [0, 2],
					data: [null,null],
					form: null,
					error: null
				}
			});
		</script>
	</div>
</body>
<style>
	/* prettier-ignore */
	html,
	body,
	div,
	span,
	applet,
	object,
	iframe,
	h1,
	h2,
	h3,
	h4,
	h5,
	h6,
	p,
	blockquote,
	pre,
	a,
	abbr,
	acronym,
	address,
	big,
	cite,
	code,
	del,
	em,
	img,
	ins,
	kbd,
	q,
	s,
	samp,
	small,
	strike,
	strong,
	sub,
	sup,
	tt,
	var,
	b,
	u,
	i,
	center,
	dl,
	dt,
	dd,
	ol,
	ul,
	li,
	fieldset,
	form,
	label,
	legend,
	table,
	caption,
	tbody,
	tfoot,
	thead,
	tr,
	th,
	td,
	article,
	aside,
	canvas,
	details,
	embed,
	figure,
	figcaption,
	footer,
	header,
	menu,
	nav,
	output,
	section,
	summary,
	time,
	mark,
	audio,
	video {
		margin: 0;
		padding: 0;
		border: 0;
		font-size: 100%;
		font: inherit;
	}

	*,
	*::before,
	*::after {
		box-sizing: border-box;
	}

	button {
		font-size: 1em;
	}
</style>

</html>